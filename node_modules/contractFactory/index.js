var fs = require('fs');
var web3 = require('web3');

function getContract(callback){
	var path ='./contracts/contract.sol'
	fs.readFile(path, compileContract);

	function compileContract(error, data){
		if(!error){
			//remove all newlines so that contract can be compiled.
			contractSource = String(data).replace(/(\r\n|\n|\r)/gm,"");
			web3.eth.compile.solidity(contractSource, callback);
		}else{
			callback(error);
		}
	}
}

function getAbi(callback){
	getContract(generateAbi);

	function generateAbi(error, contract){
		if(!error){
			callback(error, contract.customCoin.info.abiDefinition);
		}else{
			callback(error);
		}
	}
}


module.exports = {
  getContract : getContract,
  getAbi : getAbi,
}